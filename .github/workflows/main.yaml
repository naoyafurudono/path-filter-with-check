name: main

on:
  workflow_dispatch:
  push:

jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: hello
        run: echo "hello world"
  call-sub1:
    needs: main
    uses: ./.github/workflows/sub1.yaml
  call-sub2:
    needs: main
    uses: ./.github/workflows/sub2.yaml
  check:
    # 依存するジョブが全て成功したときにのみ実行され、常に成功するジョブ
    # ブランチプロテクションではこれの成功をマージ条件にすると良い
    needs: [call-sub1, call-sub2]
    runs-on: ubuntu-latest
    steps:
      - name: congrat!
        run: echo 🎉

