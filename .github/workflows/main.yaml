name: main

on:
  workflow_dispatch:
  push:

jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: hello
        run: echo "hello world"
  call-sub1:
    needs: main
    uses: ./.github/workflows/sub1.yaml
  call-sub2:
    needs: main
    uses: ./.github/workflows/sub2.yaml
  check:
    # sub1とsub2が成功したら成功する
    needs: [call-sub1, call-sub2]
    runs-on: ubuntu-latest
    steps:
      - name: fail if sub1 or sub2 failed
        if: failure()
        run: exit 1

